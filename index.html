import cv2
import numpy as np
import urllib.request
import matplotlib.pyplot as plt

video_url = "https://avtshare01.rz.tu-ilmenau.de/avt-vqdb-uhd-1/test_1/segments/bigbuck_bunny_8bit_15000kbps_1080p_60.0fps_h264.mp4"
video_path = "video.mp4"
urllib.request.urlretrieve(video_url, video_path)

cap = cv2.VideoCapture(video_path)
if not cap.isOpened():
    raise Exception("Could not open video file.")

processed_frames = []
frame_count = 0

while True:
    ret, frame = cap.read()
    if not ret:
        break

    gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)

    if frame_count == 0:
        plt.imshow(gray, cmap='gray')
        plt.title("First Frame - Grayscale")
        plt.axis('off')
        plt.show()

    resized = cv2.resize(gray, (128, 128))

    if frame_count == 0:
        plt.imshow(resized, cmap='gray')
        plt.title("First Frame - Grayscale + Resized (128x128)")
        plt.axis('off')
        plt.show()

    processed_frames.append(resized)
    frame_count += 1

cap.release()
